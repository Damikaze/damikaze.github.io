<html>
    <head>
        <title>Application Vigenere</title>

        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.10.4/themes/flick/jquery-ui.css">
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="css/switch.css">
        <link rel="shortcut icon" href="img/favicon.ico">
    </head>
    <body>
        <div class="container">
            <!-- -- Accueil -- -->

            <div id="home">
                <div class="row">
                    <h1 id="titre">Chiffre de Vigenere : l'application</h1>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <a class="btn btn-default center-block" id="goto_part1">Crypter / Décrypter</a>
                    </div>
                    <div class="col-md-6">
                        <a class="btn btn-default center-block" id="goto_part2">Cryptanalyse</a>
                    </div>
                </div>
                <br/>
                <div class="row">
                    <a id="lien_presentation" class="btn btn-warning center-block" data-toggle="modal" data-target="#modalPresentation">
                        Le chiffre de Vigenere, c'est quoi ?
                    </a>
                </div>
            </div>

            <!-- -- Cryptage / Décryptage -- -->

            <div id="part1" style="display:none;">
                <div class="row">
                    <button class="goto_home btn btn-primary col-xs-3">
                        <div class="hidden-xs hidden-sm">
                            <span class="glyphicon glyphicon-chevron-left"></span> Retour à la page d'accueil
                        </div>
                        <span class="visible-xs visible-sm glyphicon glyphicon-home"></span>
                    </button>
                </div>
                <br/>
                <div class="row">
                    <legend>Informations d'entrée</legend>
                    <label>Texte :</label>
                    <textarea rows=5 id="input" class="form-control"></textarea>
                </div>
                <br/>
                <div class="row">
                    <div class="form-group col-xs-3">
                        <label id="label_action" class="col-xs-12 margin-top">Action</label>
                        <br/>
                        <span class="col-xs-12 label-interrupteur">Crypter</span>
                        <br/>
                        <div class="switch demo">
                            <input type="checkbox" id="interrupteur" checked="checked">
                            <label></label>
                        </div>
                        <span class="col-xs-12 label-interrupteur">Décrypter</span>
                    </div>
                    <div class="form-group col-xs-9">
                        <label for="cle" id="label_cle" class="col-sm-2 margin-top">Clé:</label>
                        <div class="col-sm-7 nopadding">
                            <input type="text" id="cle1" name="cle" class="form-control"/>
                        </div>
                        <div class="col-sm-3">
                            <a id="action1" class="btn btn-primary col-xs-12">Crypter</a>
                        </div>
                    </div>
                </div>
                <br/>
                <div class="row">
                    <legend>Sortie</legend>
                    <textarea rows=5 id="output" class="form-control"></textarea>
                </div>
            </div>

            <!-- -- Cryptanalyse -- -->

            <div id="part2" style="display:none;">
                <!-- Boutons du haut -->
                <div class="row">
                    <button class="goto_home btn btn-primary col-sm-3 col-xs-2">
                        <div class="hidden-xs hidden-sm">
                            <span class="glyphicon glyphicon-chevron-left"></span> Retour à la page d'accueil
                        </div>
                        <span class="visible-xs visible-sm glyphicon glyphicon-home"></span>
                    </button>

                    <div class="col-sm-offset-1 col-sm-5 col-xs-8">
                        <select id="menu_langue" class="form-control">
                            <option selected="selected" disabled="true" style="display:none;">
                                Langage ? (Défaut : fr)
                            </option>
                            <option value="fr">Français</option>
                            <option value="en">Anglais</option>
                        </select>
                    </div>

                    <button id="aide" class="btn btn-warning pull-right col-sm-offset-1 col-sm-2 col-xs-2" data-toggle="modal" data-target="#modalAide">
                        <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                        <span class="hidden-xs hidden-sm"> Aide</span>
                    </button>
                </div>
                <br/>

                <legend>Cryptanalyse</legend>

                <!-- Zone de texte -->
                <div class="row">
                    <label class="margin-top">Texte crypté :</label>
                    <button id="oubliCryptage" class="btn btn-default pull-right" data-toggle="modal" data-target="#modalCryptage">Mon texte n'est pas crypté !</button>

                    <textarea rows=6 id="cryptedText" class="form-control"></textarea>
                    <br/>

                    <button id="restart" class="btn btn-default">
                        <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
                        Recommencer l'analyse
                    </button>
                    <button id="resultat_cryptanalyse" class="btn btn-success" data-toggle="modal" data-target="#modalResultat" disabled>
                        <span class="glyphicon glyphicon-qrcode" aria-hidden="true"></span>
                        Afficher le texte décrypté
                    </button>
                </div>
                <br/>

                <legend>Résultats</legend>

                <!-- <p id="paragraph-help">Un peu d'aide pour bien utiliser les outils ci-dessous ? Cliquez sur le bouton d'info en haut à droite !</p> -->

                <!-- Tableau de la clé à deviner -->
                <h4>Clé à deviner</h4>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th class="col-xs-2 text-center">Taille</th>
                            <th class="col-xs-7 text-center">Changer de caractère</th>
                            <th class="col-xs-3 text-center" colspan=2>Indices de coincidence</th>
                        </tr>
                    </thead>
                    <tbody class="text-center">
                        <tr>
                            <td rowspan=2>
                                <div class="btn-group btn-group-lg hidden-xs">
                                    <button class="btn btn-danger cle_moins">
                                        <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
                                    </button>
                                    <button class="btn btn-primary cle_plus">
                                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                                    </button>
                                </div>
                                <div class="btn-group-vertical btn-group-lg visible-xs">
                                    <button class="btn btn-primary cle_plus">
                                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                                    </button>
                                    <button class="btn btn-danger cle_moins">
                                        <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
                                    </button>
                                </div>
                            </td>
                            <td rowspan=2>
                                <div class="row">
                                    <div class="col-sm-2 hidden-xs">
                                        <button class="btn btn-default pull-right cle_gauche">
                                            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                                        </button>
                                    </div>
                                    <div class="col-xs-12 col-sm-8" id="cle_trouvee_div">
                                        <p id="cle_trouvee"></p>
                                    </div>
                                    <div class="col-sm-2 hidden-xs">
                                        <button class="btn btn-default pull-left cle_droite">
                                            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                                        </button>
                                    </div>
                                    <br/>
                                    <a class="btn btn-default col-xs-6 visible-xs cle_gauche"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span></a>
                                    <a class="btn btn-default col-xs-6 visible-xs cle_droite"><span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
                                </div>
                            </td>
                            <td>Texte</td>
                            <td> <span id="ic_texte"></span> </td>
                        </tr>
                        <tr>
                            <td>Langue</td>
                            <td> <span id="ic_theorique"></span> </td>
                        </tr>
                    </tbody>
                </table>

                <div id="row-apercu" class="row">
                    <label for="apercu">Voici ce que donne le décryptage si la clé ci-dessus est correcte ...</label>
                    <p id="apercu"></p>
                </div>

                <div class="row">
                    <h4 class="col-xs-6">Outils statistiques</h4>
                    <button id="statsPlus" class="btn btn-warning pull-right" data-toggle="modal" data-target="#modalStatsPlus">Encore plus de statistiques !</button>
                </div>

                <!--<div class="row">
                    <br/>
                    <div class="slider"></div>
                    <br/>
                    <a id="btn_decalage_gauche" class="btn btn-info col-xs-6">
                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                    </a>
                    <a id="btn_decalage_droite" class="btn btn-info col-xs-6">
                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                    </a>
                </div>-->

                <!-- Dans ce bloc, l'histogramme des fréquences -->
                <div class="row">
                    <div id="freq_chart_div" class="center-block"></div>
                </div>
                <br/>
            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="row">
                    <div class="col-xs-9 col-sm-10">
                        <p id="credits">Image fournie par Razlan sur 
                            <a href="https://www.flickr.com/">flickr.com</a>
                             sous licence 
                            <a href="http://creativecommons.org/">CreativeCommons</a>
                        </p>
                    </div>
                    <div class="col-xs-3 col-sm-2">
                        <img id="E" class="pull-right" width="90" src="http://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-nc-nd.png"></img>
                    </div>
                </div>
            </div>
        </footer>

        <!-- -- Modal de présentation du chiffre de Vigenere -- -->

        <div class="modal fade" id="modalPresentation" tabindex="-1" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title">Présentation du chiffre de Vigenère</h4>
                    </div>
                    <div class="modal-body">
                        <table id="table-pedagogie" class="table table-bordered table-striped table-centered">
                            <tr>
                                <td>M</td><td>E</td><td>S</td><td>S</td><td>A</td><td>G</td><td>E</td>
                                <td>S</td><td>E</td><td>C</td><td>R</td><td>E</td><td>T</td>
                            </tr>
                            <tr class="small-row">
                                <td>+</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td>
                                <td>+</td><td>+</td><td>+</td><td>+</td><td>+</td><td>+</td>
                            </tr>
                            <tr>
                                <td>C</td><td>O</td><td>D</td><td>E</td><td>C</td><td>O</td><td>D</td>
                                <td>E</td><td>C</td><td>O</td><td>D</td><td>E</td><td>C</td>
                            </tr>
                            <tr class="small-row">
                                <td>=</td><td>=</td><td>=</td><td>=</td><td>=</td><td>=</td><td>=</td>
                                <td>=</td><td>=</td><td>=</td><td>=</td><td>=</td><td>=</td>
                            </tr>
                            <tr>
                                <td>O</td><td>S</td><td>V</td><td>W</td><td>C</td><td>U</td><td>H</td>
                                <td>W</td><td>G</td><td>Q</td><td>U</td><td>I</td><td>V</td>
                            </tr>
                        </table>

                        <p>Voilà ! C'est simple le chiffre de Vigenere, non ? Allez, on va expliquer plus en détails.</p>

                        <h4>Explications</h4>

                        <p>Le chiffre (ou chiffrement) de Vigenère est un procédé de cryptographie polyalphabétique, c'est-à-dire qu'on utilise un mot appelé "clé" de plusieurs lettres pour réaliser le chiffrement (ici, c'est le mot "CODE").</p>
                        <p>On procède à un décalage de l'alphabet déterminé par chaque caractère de la clé. Par convention, 'A' correspond à un décalage nul, 'B' un décalage de 1, 'C' de 2, etc... Exemple du tableau : pour la 1ère lettre 'M', je code avec un 'C' (décalage de 2 lettres), et la lettre devient un 'O' (M -> N -> O). Et si, en décalant, on déborde et qu'on va plus loin que le 'Z', et bien, on repart pour un tour : Y -> Z -> A -> B...</p>
                        <p>Ce principe de décalage implique qu'une lettre est associée à une et une seule autre lettre par cette transformation.</p>
                        <p>Or, l'interêt du chiffre de Vigenère est que deux lettres identiques du texte à crypter ne donnent pas toujours les mêmes lettres dans le texte crypté et vice versa.</p>

                        <h4>Pourquoi ? Et comment décrypter alors ?</h4>

                        <p>Si vous utilisez une clé d'une seule lettre, le décalage appliqué est identique pour toutes les lettres. Et déterminer le décalage unique à tout le texte est très simple : trouvez la lettre qui apparaît le plus dans le texte crypté, et on est presque sûr qu'elle correspond à la lettre la plus fréquente théoriquement dans la langue du texte à déchiffrer. Une petite soustraction, et on a la taille du décalage ! Pour la culture (c'est pour moi, c'est cadeau), ce chiffrage monoalphabétique s'appelle chiffre de César.</p>
                        <p>Pour le chiffre de Vigenère (avec une clé de N lettres), l'astuce va etre la même, mais il va falloir au préalable deviner la taille de la clé. Et si on devine juste, on sait alors que, périodiquement (1 fois sur N), une lettre du texte crypté correspond toujours à la même lettre du texte à déchiffrer (parce qu'elle a été codée avec le même caractère de la clé, regardez dans le tableau au-dessus les deux S qui deviennent des W).</p>

                        <h4>J'ai toujours pas compris !</h4>

                        <p>Et bien, il vous reste ... <a href="http://fr.wikipedia.org/wiki/Chiffre_de_Vigen%C3%A8re" target="_blank">la page Wikipédia !</a> On ne sait jamais.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- -- Modal de présentation du texte décrypté par cryptanalyse -- -->

        <div class="modal fade" id="modalResultat" tabindex="-1" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title">Résultat de la cryptanalyse</h4>
                    </div>
                    <div class="modal-body">
                        <p>Avec la clé "<b id="cleDevinee"></b>", voici ce que donne le texte décrypté :</p>
                        <textarea id="texteDecrypte" class="form-control" rows=5></textarea>
                        <br/>
                        <p>Ajoutez des espaces pour aérer et vérifier que le texte est correct.</p>
                    </div>
                    <div class="modal-footer">
                        Merci d'avoir utilisé notre application !
                    </div>
                </div>
            </div>
        </div>

        <!-- -- Modal d'aide à l'utilisation du module de cryptanalyse -- -->

        <div class="modal fade" id="modalAide" tabindex="-1" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title">Comment utiliser l'application de cryptanalyse ?</h4>
                    </div>
                    <div class="modal-body">
                        <h4 style="margin-top:0px;">Le texte à analyser</h4>
                        <p>Copiez-collez dans la zone de texte principale le texte crypté, l'analyse sera lancée automatiquement. Si le texte n'est pas crypté, depliez le panneau juste au-dessus.</p>
                        <img src="img/aide/texte_crypte.png" width="100%"></img>

                        <h4>Le tableau de la clé </h4>
                        <p>Les fonctionnalités résumées en 5 points pour percer la clé de chiffrement:</p>
                        <img src="img/aide/tab_cle.png" width="100%"></img>
                        <ul class="list-unstyled">
                            <li>1) Ajouter ou retirer une lettre en fin de clé</li>
                            <li>2) La clé, avec en gras, la lettre ciblée de la clé, pour laquelle on affiche les fréquences d'apparition des lettres du texte codées avec cette lettre de la clé</li>
                            <li>3) Déplacer le focus sur l'une des lettres de la clé, à gauche ou à droite</li>
                            <li>4) Les indices de coincidence, l'un théorique de la langue du texte crypté, l'autre propre au texte crypté. Ils représentent la probabilité que 2 lettres choisies au hasard dans le texte soient identiques</li>
                            <li>5) Un pronostic sur la taille probable de la clé de chiffrement</li>
                        </ul>

                        <h4>L'histogramme</h4>
                        <p>Il représente, en bleu, les fréquences d'apparition des lettres dans la langue du texte (modifiable via le menu déroulant en haut de page), et en rouge, les fréquences "partielles" du texte crypté, "partielles" car uniquement les lettres du texte crypté qui sont en principe chiffrés par le caractère ciblé de la clé, choisi dans le tableau.</p>
                        <img src="img/aide/histogramme.gif" width="100%"></img>
                        <p>Vous pouvez manipuler l'histogramme pour superposer les deux histogrammes et deviner la valeur du caractère de la clé ciblé. En bougeant l'histogramme rouge, la caractère ciblé se modifie aussi. Voici les possibilités d'actions à exécuter sur l'histogramme :</p>
                        <img src="img/aide/actions.jpg" width="100%"></img>

                        <h4>Les résultats</h4>
                        <p>Dès que vous pensez avoir trouvé la bonne clé, vous pouvez retrouver le résultat complet en appuyant sur le bouton vert en-dessous de la zone de texte. Mais vous déjà voir un apercu du déchiffrage en direct en-dessous de l'histogramme, avec en gras les caractères du début du texte chiffrés par le caractère de la clé que vous avez ciblé.</p>
                        <img src="img/aide/apercu.png" width="100%"></img>
                    </div>
                </div>
            </div>
        </div>

        <!-- -- Modal de cryptage de secours dans le module de cryptanalyse -- -->

        <div class="modal fade" id="modalCryptage" tabindex="-1" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title">Analyser un texte crypté, c'est mieux !</h4>
                    </div>
                    <div class="modal-body">
                        <p>Rentrez le texte original dans la zone de texte ci-dessous, et la clé de chiffrage dans le champ correspondant. Nous nous occupons du reste : formattage, cryptage, et analyse !</p>

                        <div class="input-group">
                            <span class="input-group-addon">Clé :</span>
                            <input type="text" id="cle2" class="form-control">
                        </div>
                        <br/>

                        <textarea rows=6 id="texteACrypter" class="form-control"></textarea>
                        <br/>

                        <button id="action2" class="btn btn-default" type="button">Crypter</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- -- Modal de statistiques supplémentaires -- -->

        <div class="modal fade" id="modalStatsPlus" tabindex="-1" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title">Pour vous aiguiller sur la bonne taille de clé</h4>
                    </div>
                    <div class="modal-body">
                        <h4>Indices de coincidence selon la taille de la clé</h4>
                        <div class="row">
                            <div id="indice_chart_div" class="center-block"></div>
                        </div>
                        <p>
                            Si les courbes rouge et bleue sont proches à une abscisse N, alors il est très probable que la clé soit de taille N. A vous désormais de trouver les bons caractères !
                        </p>

                        <h4>Le devin</h4>
                        <div class="row">
                            <img class="col-xs-4" src="img/magicien_cartes.jpg"/>
                            <div class="col-xs-8">
                                <p>
                                    Une dernière statistique, un peu moins fiable et que nous appelerons "formule du devin", est calculée à partir de l'équation ci-dessous.
                                </p>
                                <img src="img/formule_devin.gif" style="width: 100%"/>
                                <p>
                                    Alors, devin, dites-nous tout !
                                </p>
                                <p>
                                    "Je vois, je vois ... une taille de la clé de chiffrement entre 
                                    <span id="tailleDevinee"></span> caractères. J'ai bon ?"
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Scripts exterieurs : jQuery, Bootstrap et Google Charts -->
        <script src="https://code.jquery.com/jquery-2.1.1.js"></script>
        <script src="https://code.jquery.com/ui/1.11.1/jquery-ui.js"></script>
        <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>

        <!-- Scripts internes -->
        <script type="text/javascript" src="js/anim-titre.js"></script>
        <script type="text/javascript" src="js/variables.js"></script>
        <script type="text/javascript" src="js/fonctions.js"></script>
        <script type="text/javascript" src="js/evenements.js"></script>
    </body>
</html>